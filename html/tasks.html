<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>怪兽图鉴</title>
		<link type="text/css" rel="styleSheet" href="../css/base.css" />
		<link type="text/css" rel="styleSheet" href="../css/tasks.css" />
		<script src="../js/jquery-3.4.1.js" type="application/javascript"></script>
		<script src="../js/data.js" type="application/javascript"></script>
		<script type="application/javascript">
			$(function() {
				$(".back_div").on("click", function() {
					location.href = "tasklist.html";
				});
				
				let tsktype = CommonUtil.getRequest()["type"];
				
				let tmptasklist = CommonUtil.getTaskState();
				if (tmptasklist == null) {
					alert("TaskList is null");
					return;
				}
				for (i in tmptasklist) {
					if( tmptasklist[i].taskname.indexOf(tsktype) == -1){
						continue;
					}
					let tmp_div_str = '';
					let mon_arr = tmptasklist[i].taskcontent;
					let tmp_mon_0 = MonList[mon_arr[0]];
					let tmp_mon_1 = MonList[mon_arr[1]];
					let tmp_mon_2 = MonList[mon_arr[2]];
					let star_num = tmp_mon_0.star + tmp_mon_1.star + tmp_mon_2.star;
					tmp_div_str = tmp_div_str + '<div class="task_div" task_name="' + i + '">';
					tmp_div_str = tmp_div_str + '<div class="task_name_div"><br>' + tmptasklist[i].taskname + "<br>★×" + star_num + '</div>';
					tmp_div_str = tmp_div_str + '<div class="task_img_div"><img src="../img/' + tmp_mon_0.img + '"></div>';
					tmp_div_str = tmp_div_str + '<div class="task_img_div"><img src="../img/' + tmp_mon_1.img + '"></div>';
					tmp_div_str = tmp_div_str + '<div class="task_img_div"><img src="../img/' + tmp_mon_2.img + '"></div>';
					let tml_color_class = tmptasklist[i].isComplete == "yes" ? "background_green" : "background_red";
					tmp_div_str = tmp_div_str + '<div class="task_state_div"><span class="' + tml_color_class + '">' + tmptasklist[i]
						.isComplete + '</span></div>';
					tmp_div_str = tmp_div_str + '</div>';
					$(tmp_div_str).appendTo($(".content_div"));
				}
				$(".task_div").on("click", function() {
					let _url = "battle.html?taskname=" + $(this).attr("task_name");
					location.href = _url;
				});
			});
		</script>
	</head>
	<body>
		<div class="header_div">任务清单</div>
		<div class="back_div">
			&lt;-</div>
		<div class="content_div">

		</div>
		</div>
	</body>
</html>
